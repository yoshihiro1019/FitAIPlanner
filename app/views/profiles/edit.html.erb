<div class="container pt-3">
  <div class="row">
    <div class="col-lg-10 offset-lg-1">
      <h1 class="float-left mb-5">プロフィール編集</h1>
      <%= form_for @user, url: profile_path, html: { multipart: true } do |f| %>
        <div class="form-group">
          <%= f.label :email %>
          <%= f.text_field :email, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :first_name %>
          <%= f.text_field :first_name, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :last_name %>
          <%= f.text_field :last_name, class: "form-control" %>
        </div>
        <div class="form-group">
          <%= f.label :avatar, "アバター" %>
          <div class="input-group">
            <input type="text" class="form-control" readonly id="avatar_name">
            <div class="input-group-append">
              <div class="custom-file">
                <%= f.file_field :avatar, class: "custom-file-input", id: "avatar" %>
                <%= f.label :avatar, "ファイルを選択", class: "custom-file-label", for: "avatar" %>
              </div>
            </div>
          </div>
          <% if @user.avatar? %>
            <div class="mt-2">
              <%= image_tag @user.avatar.url, class: 'rounded-circle', size: '50x50' %>
            </div>
          <% end %>
        </div>
        <div class="form-group">
          <%= f.submit "更新", class: "btn btn-primary" %>
          <%= link_to '戻る', profile_path, class: "btn btn-secondary ml-2" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<%= javascript_tag do %>
  document.addEventListener("DOMContentLoaded", function() {
    document.getElementById("avatar").addEventListener("change", function(e) {
      var fileName = e.target.files[0].name;
      document.getElementById("avatar_name").value = fileName;
      document.querySelector(".custom-file-label").innerText = fileName;
    });
  });
<% end %>
